<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - Cloud Encryption</title>
    
    <style>
      body {
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          background-color: #1e1e1e;
          color: #f4f4f4;
          margin: 0;
          padding: 0;
          display: flex;
          flex-direction: column;
          align-items: center;
          min-height: 100vh;
      }

      .container {
          background-color: #252526;
          padding: 40px 50px;
          border-radius: 12px;
          box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
          width: 90%;
          max-width: 600px;
          margin-top: 50px;
      }

      h1, h3 {
          color: #d1c4e9;
          border-bottom: 2px solid #5e35b1;
          padding-bottom: 8px;
          text-align: left;
          margin-bottom: 20px;
      }

      form {
          margin-top: 10px;
          padding: 15px;
          background-color: #2d2d2d;
          border-radius: 8px;
          margin-bottom: 25px;
          display: flex;
          align-items: center;
          gap: 15px;
      }
      
      input[type="file"] {
          flex-grow: 1;
          padding: 8px;
          border: 1px solid #505050;
          border-radius: 6px;
          background-color: #3e3e3e; 
          color: white;
      }

      button {
          background-color: #673ab7;
          color: white;
          padding: 10px 15px;
          border: none;
          border-radius: 6px;
          cursor: pointer;
          font-size: 16px;
          font-weight: bold;
          transition: background-color 0.3s, transform 0.1s;
      }

      button:hover {
          background-color: #5e35b1;
          transform: translateY(-1px);
      }

      hr {
          border: 0;
          height: 1px;
          background-color: #444;
          margin: 25px 0;
      }

      /* Flash Messages Styling */
      .flashes {
          list-style: none;
          padding: 0;
          margin: 10px 0 20px 0;
          text-align: center;
      }
      .flashes li {
          padding: 10px 20px;
          margin-bottom: 10px;
          border-radius: 6px;
          font-weight: bold;
      }
      .success { background-color: #004d40; color: #a7ffeb; border: 1px solid #00695c; } /* Changed color for better dark-theme visibility */
      .danger { background-color: #8b0000; color: #ffcccb; border: 1px solid #a52a2a; }
      .info { background-color: #004d40; color: #a7ffeb; border: 1px solid #00695c; }
      .warning { background-color: #8a6d3b; color: #ffebcd; border: 1px solid #a0522d; }

      /* Dashboard Specifics */
      a {
          color: #bb86fc;
          text-decoration: none;
          font-weight: bold;
      }
      a:hover {
          text-decoration: underline;
      }
      
      .generate-key-link {
          display: inline-block;
          padding: 8px 12px;
          background-color: #404040; /* Background for link button */
          border: 1px solid #bb86fc;
          border-radius: 4px;
          margin-top: 10px;
          transition: background-color 0.3s;
      }
      .generate-key-link:hover {
          background-color: #3a304a;
          text-decoration: none;
      }

      .sign-out-btn {
          background-color: #e57373;
          margin-left: 20px;
      }
      .sign-out-btn:hover {
          background-color: #ef5350;
      }
      
      .user-info {
          display: flex;
          align-items: center;
          margin-bottom: 25px;
      }
    </style>
    </head>
<body>
    <div class="container">
        <h1>Welcome to Cloud Encryption Portal</h1>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <ul class="flashes">
            {% for category, message in messages %}
              <li class="{{ category }}">{{ message }}</li>
            {% endfor %}
            </ul>
          {% endif %}
        {% endwith %}
        
        <div class="user-info">
            <p>Logged in as: <b>{{ session.get('username', 'User') }}</b></p>
            <a href="{{ url_for('logout') }}"><button class="sign-out-btn">Sign Out</button></a>
        </div>

        <hr>

        <h3>Generate Key</h3>
        <p>
            <a href="{{ url_for('generate') }}" class="generate-key-link">ðŸ”‘ Generate New Key (DANGER: Overwrites existing key)</a>
        </p>

        <hr>

        <h3>Encrypt File</h3>
        <p>Uploads a file and returns an `.encrypted` version.</p>
        <form action="{{ url_for('encrypt') }}" method="POST" enctype="multipart/form-data">
            <input type="file" name="file" required>
            <button type="submit">Encrypt</button>
        </form>

        <hr>

        <h3>Decrypt File</h3>
        <p>Uploads an `.encrypted` file and returns the original content.</p>
        <form action="{{ url_for('decrypt') }}" method="POST" enctype="multipart/form-data">
            <input type="file" name="file" required>
            <button type="submit">Decrypt</button>
        </form>
    </div>
</body>
</html>